import Check from"./Check.js";import defaultValue from"./defaultValue.js";import defined from"./defined.js";import DeveloperError from"./DeveloperError.js";import JulianDate from"./JulianDate.js";function TimeInterval(t){t=defaultValue(t,defaultValue.EMPTY_OBJECT),this.start=defined(t.start)?JulianDate.clone(t.start):new JulianDate,this.stop=defined(t.stop)?JulianDate.clone(t.stop):new JulianDate,this.data=t.data,this.isStartIncluded=defaultValue(t.isStartIncluded,!0),this.isStopIncluded=defaultValue(t.isStopIncluded,!0)}Object.defineProperties(TimeInterval.prototype,{isEmpty:{get:function(){var t=JulianDate.compare(this.stop,this.start);return t<0||0===t&&(!this.isStartIncluded||!this.isStopIncluded)}}});var scratchInterval={start:void 0,stop:void 0,isStartIncluded:void 0,isStopIncluded:void 0,data:void 0};TimeInterval.fromIso8601=function(t,e){Check.typeOf.object("options",t),Check.typeOf.string("options.iso8601",t.iso8601);var a=t.iso8601.split("/");if(2!==a.length)throw new DeveloperError("options.iso8601 is an invalid ISO 8601 interval.");var n=JulianDate.fromIso8601(a[0]),i=JulianDate.fromIso8601(a[1]),r=defaultValue(t.isStartIncluded,!0),l=defaultValue(t.isStopIncluded,!0),s=t.data;return defined(e)?(e.start=n,e.stop=i,e.isStartIncluded=r,e.isStopIncluded=l,e.data=s,e):(scratchInterval.start=n,scratchInterval.stop=i,scratchInterval.isStartIncluded=r,scratchInterval.isStopIncluded=l,scratchInterval.data=s,new TimeInterval(scratchInterval))},TimeInterval.toIso8601=function(t,e){return Check.typeOf.object("timeInterval",t),JulianDate.toIso8601(t.start,e)+"/"+JulianDate.toIso8601(t.stop,e)},TimeInterval.clone=function(t,e){if(defined(t))return defined(e)?(e.start=t.start,e.stop=t.stop,e.isStartIncluded=t.isStartIncluded,e.isStopIncluded=t.isStopIncluded,e.data=t.data,e):new TimeInterval(t)},TimeInterval.equals=function(t,e,a){return t===e||defined(t)&&defined(e)&&(t.isEmpty&&e.isEmpty||t.isStartIncluded===e.isStartIncluded&&t.isStopIncluded===e.isStopIncluded&&JulianDate.equals(t.start,e.start)&&JulianDate.equals(t.stop,e.stop)&&(t.data===e.data||defined(a)&&a(t.data,e.data)))},TimeInterval.equalsEpsilon=function(t,e,a,n){return a=defaultValue(a,0),t===e||defined(t)&&defined(e)&&(t.isEmpty&&e.isEmpty||t.isStartIncluded===e.isStartIncluded&&t.isStopIncluded===e.isStopIncluded&&JulianDate.equalsEpsilon(t.start,e.start,a)&&JulianDate.equalsEpsilon(t.stop,e.stop,a)&&(t.data===e.data||defined(n)&&n(t.data,e.data)))},TimeInterval.intersect=function(t,e,a,n){if(Check.typeOf.object("left",t),!defined(e))return TimeInterval.clone(TimeInterval.EMPTY,a);var i=t.start,r=t.stop,l=e.start,s=e.stop,d=JulianDate.greaterThanOrEquals(l,i)&&JulianDate.greaterThanOrEquals(r,l),o=!d&&JulianDate.lessThanOrEquals(l,i)&&JulianDate.lessThanOrEquals(i,s);if(!d&&!o)return TimeInterval.clone(TimeInterval.EMPTY,a);var u=t.isStartIncluded,c=t.isStopIncluded,p=e.isStartIncluded,I=e.isStopIncluded,f=JulianDate.lessThan(r,s);return defined(a)||(a=new TimeInterval),a.start=d?l:i,a.isStartIncluded=u&&p||!JulianDate.equals(l,i)&&(d&&p||o&&u),a.stop=f?r:s,a.isStopIncluded=f?c:c&&I||!JulianDate.equals(s,r)&&I,a.data=defined(n)?n(t.data,e.data):t.data,a},TimeInterval.contains=function(t,e){if(Check.typeOf.object("timeInterval",t),Check.typeOf.object("julianDate",e),t.isEmpty)return!1;var a=JulianDate.compare(t.start,e);if(0===a)return t.isStartIncluded;var n=JulianDate.compare(e,t.stop);return 0===n?t.isStopIncluded:a<0&&n<0},TimeInterval.prototype.clone=function(t){return TimeInterval.clone(this,t)},TimeInterval.prototype.equals=function(t,e){return TimeInterval.equals(this,t,e)},TimeInterval.prototype.equalsEpsilon=function(t,e,a){return TimeInterval.equalsEpsilon(this,t,e,a)},TimeInterval.prototype.toString=function(){return TimeInterval.toIso8601(this)},TimeInterval.EMPTY=Object.freeze(new TimeInterval({start:new JulianDate,stop:new JulianDate,isStartIncluded:!1,isStopIncluded:!1}));export default TimeInterval;