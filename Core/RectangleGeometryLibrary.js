import Cartesian3 from"./Cartesian3.js";import Cartographic from"./Cartographic.js";import defined from"./defined.js";import DeveloperError from"./DeveloperError.js";import GeographicProjection from"./GeographicProjection.js";import CesiumMath from"./Math.js";import Matrix2 from"./Matrix2.js";import Rectangle from"./Rectangle.js";var cos=Math.cos,sin=Math.sin,sqrt=Math.sqrt,RectangleGeometryLibrary={computePosition:function(t,r,a,n,e,o,i){var s=r.radiiSquared,c=t.nwCorner,C=t.boundingRectangle,h=c.latitude-t.granYCos*n+e*t.granXSin,g=cos(h),u=sin(h),l=s.z*u,m=c.longitude+n*t.granYSin+e*t.granXCos,p=g*cos(m),w=g*sin(m),M=s.x*p,S=s.y*w,d=sqrt(M*p+S*w+l*u);if(o.x=M/d,o.y=S/d,o.z=l/d,a){var R=t.stNwCorner;defined(R)?(h=R.latitude-t.stGranYCos*n+e*t.stGranXSin,m=R.longitude+n*t.stGranYSin+e*t.stGranXCos,i.x=(m-t.stWest)*t.lonScalar,i.y=(h-t.stSouth)*t.latScalar):(i.x=(m-C.west)*t.lonScalar,i.y=(h-C.south)*t.latScalar)}}},rotationMatrixScratch=new Matrix2,nwCartesian=new Cartesian3,centerScratch=new Cartographic,centerCartesian=new Cartesian3,proj=new GeographicProjection;function getRotationOptions(t,r,a,n,e,o,i){var s=Math.cos(r),c=n*s,C=a*s,h=Math.sin(r),g=n*h,u=a*h;nwCartesian=proj.project(t,nwCartesian),nwCartesian=Cartesian3.subtract(nwCartesian,centerCartesian,nwCartesian);var l=Matrix2.fromRotation(r,rotationMatrixScratch);nwCartesian=Matrix2.multiplyByVector(l,nwCartesian,nwCartesian),nwCartesian=Cartesian3.add(nwCartesian,centerCartesian,nwCartesian),o-=1,i-=1;var m=(t=proj.unproject(nwCartesian,t)).latitude,p=m+o*u,w=m-c*i,M=m-c*i+o*u,S=Math.max(m,p,w,M),d=Math.min(m,p,w,M),R=t.longitude,f=R+o*C,j=R+i*g,O=R+i*g+o*C;return{north:S,south:d,east:Math.max(R,f,j,O),west:Math.min(R,f,j,O),granYCos:c,granYSin:g,granXCos:C,granXSin:u,nwCorner:t}}RectangleGeometryLibrary.computeOptions=function(t,r,a,n,e,o,i){var s,c,C,h,g,u=t.east,l=t.west,m=t.north,p=t.south,w=!1,M=!1;m===CesiumMath.PI_OVER_TWO&&(w=!0),p===-CesiumMath.PI_OVER_TWO&&(M=!0);var S=m-p;C=(g=l>u?CesiumMath.TWO_PI-l+u:u-l)/((s=Math.ceil(g/r)+1)-1),h=S/((c=Math.ceil(S/r)+1)-1);var d=Rectangle.northwest(t,o),R=Rectangle.center(t,centerScratch);0===a&&0===n||(R.longitude<d.longitude&&(R.longitude+=CesiumMath.TWO_PI),centerCartesian=proj.project(R,centerCartesian));var f=h,j=C,O=Rectangle.clone(t,e),v={granYCos:f,granYSin:0,granXCos:j,granXSin:0,nwCorner:d,boundingRectangle:O,width:s,height:c,northCap:w,southCap:M};if(0!==a){var X=getRotationOptions(d,a,C,h,R,s,c);if(m=X.north,p=X.south,u=X.east,l=X.west,m<-CesiumMath.PI_OVER_TWO||m>CesiumMath.PI_OVER_TWO||p<-CesiumMath.PI_OVER_TWO||p>CesiumMath.PI_OVER_TWO)throw new DeveloperError("Rotated rectangle is invalid.  It crosses over either the north or south pole.");v.granYCos=X.granYCos,v.granYSin=X.granYSin,v.granXCos=X.granXCos,v.granXSin=X.granXSin,O.north=m,O.south=p,O.east=u,O.west=l}if(0!==n){a-=n;var Y=Rectangle.northwest(O,i),x=getRotationOptions(Y,a,C,h,R,s,c);v.stGranYCos=x.granYCos,v.stGranXCos=x.granXCos,v.stGranYSin=x.granYSin,v.stGranXSin=x.granXSin,v.stNwCorner=Y,v.stWest=x.west,v.stSouth=x.south}return v};export default RectangleGeometryLibrary;