import Check from"./Check.js";import defined from"./defined.js";function Event(){this._listeners=[],this._scopes=[],this._toRemove=[],this._insideRaiseEvent=!1}function compareNumber(e,t){return t-e}Object.defineProperties(Event.prototype,{numberOfListeners:{get:function(){return this._listeners.length-this._toRemove.length}}}),Event.prototype.addEventListener=function(e,t){Check.typeOf.func("listener",e),this._listeners.push(e),this._scopes.push(t);var i=this;return function(){i.removeEventListener(e,t)}},Event.prototype.removeEventListener=function(e,t){Check.typeOf.func("listener",e);for(var i=this._listeners,s=this._scopes,n=-1,r=0;r<i.length;r++)if(i[r]===e&&s[r]===t){n=r;break}return-1!==n&&(this._insideRaiseEvent?(this._toRemove.push(n),i[n]=void 0,s[n]=void 0):(i.splice(n,1),s.splice(n,1)),!0)},Event.prototype.raiseEvent=function(){var e;this._insideRaiseEvent=!0;var t=this._listeners,i=this._scopes,s=t.length;for(e=0;e<s;e++){var n=t[e];defined(n)&&t[e].apply(i[e],arguments)}var r=this._toRemove;if((s=r.length)>0){for(r.sort(compareNumber),e=0;e<s;e++){var o=r[e];t.splice(o,1),i.splice(o,1)}r.length=0}this._insideRaiseEvent=!1};export default Event;