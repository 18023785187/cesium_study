import defaultValue from"./defaultValue.js";import defined from"./defined.js";import DeveloperError from"./DeveloperError.js";import RuntimeError from"./RuntimeError.js";function getStringFromTypedArray(e,r,t){if(!defined(e))throw new DeveloperError("uint8Array is required.");if(r<0)throw new DeveloperError("byteOffset cannot be negative.");if(t<0)throw new DeveloperError("byteLength cannot be negative.");if(r+t>e.byteLength)throw new DeveloperError("sub-region exceeds array bounds.");return r=defaultValue(r,0),t=defaultValue(t,e.byteLength-r),e=e.subarray(r,r+t),getStringFromTypedArray.decode(e)}function inRange(e,r,t){return r<=e&&e<=t}function utf8Handler(e){for(var r=0,t=0,n=0,o=128,i=191,d=[],a=e.length,f=0;f<a;++f){var u=e[f];if(0===n){if(inRange(u,0,127)){d.push(u);continue}if(inRange(u,194,223)){n=1,r=31&u;continue}if(inRange(u,224,239)){224===u&&(o=160),237===u&&(i=159),n=2,r=15&u;continue}if(inRange(u,240,244)){240===u&&(o=144),244===u&&(i=143),n=3,r=7&u;continue}throw new RuntimeError("String decoding failed.")}inRange(u,o,i)?(o=128,i=191,r=r<<6|63&u,++t===n&&(d.push(r),r=n=t=0)):(r=n=t=0,o=128,i=191,--f)}return d}getStringFromTypedArray.decodeWithTextDecoder=function(e){return new TextDecoder("utf-8").decode(e)},getStringFromTypedArray.decodeWithFromCharCode=function(e){for(var r="",t=utf8Handler(e),n=t.length,o=0;o<n;++o){var i=t[o];i<=65535?r+=String.fromCharCode(i):(i-=65536,r+=String.fromCharCode(55296+(i>>10),56320+(1023&i)))}return r},"undefined"!=typeof TextDecoder?getStringFromTypedArray.decode=getStringFromTypedArray.decodeWithTextDecoder:getStringFromTypedArray.decode=getStringFromTypedArray.decodeWithFromCharCode;export default getStringFromTypedArray;