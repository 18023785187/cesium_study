import BoundingSphere from"./BoundingSphere.js";import Cartesian3 from"./Cartesian3.js";import Check from"./Check.js";import ComponentDatatype from"./ComponentDatatype.js";import defaultValue from"./defaultValue.js";import defined from"./defined.js";import FrustumGeometry from"./FrustumGeometry.js";import Geometry from"./Geometry.js";import GeometryAttribute from"./GeometryAttribute.js";import GeometryAttributes from"./GeometryAttributes.js";import OrthographicFrustum from"./OrthographicFrustum.js";import PerspectiveFrustum from"./PerspectiveFrustum.js";import PrimitiveType from"./PrimitiveType.js";import Quaternion from"./Quaternion.js";var PERSPECTIVE=0,ORTHOGRAPHIC=1;function FrustumOutlineGeometry(e){Check.typeOf.object("options",e),Check.typeOf.object("options.frustum",e.frustum),Check.typeOf.object("options.origin",e.origin),Check.typeOf.object("options.orientation",e.orientation);var t,r,i=e.frustum,n=e.orientation,a=e.origin,o=defaultValue(e._drawNearPlane,!0);i instanceof PerspectiveFrustum?(t=PERSPECTIVE,r=PerspectiveFrustum.packedLength):i instanceof OrthographicFrustum&&(t=ORTHOGRAPHIC,r=OrthographicFrustum.packedLength),this._frustumType=t,this._frustum=i.clone(),this._origin=Cartesian3.clone(a),this._orientation=Quaternion.clone(n),this._drawNearPlane=o,this._workerName="createFrustumOutlineGeometry",this.packedLength=2+r+Cartesian3.packedLength+Quaternion.packedLength}FrustumOutlineGeometry.pack=function(e,t,r){Check.typeOf.object("value",e),Check.defined("array",t),r=defaultValue(r,0);var i=e._frustumType,n=e._frustum;return t[r++]=i,i===PERSPECTIVE?(PerspectiveFrustum.pack(n,t,r),r+=PerspectiveFrustum.packedLength):(OrthographicFrustum.pack(n,t,r),r+=OrthographicFrustum.packedLength),Cartesian3.pack(e._origin,t,r),r+=Cartesian3.packedLength,Quaternion.pack(e._orientation,t,r),t[r+=Quaternion.packedLength]=e._drawNearPlane?1:0,t};var scratchPackPerspective=new PerspectiveFrustum,scratchPackOrthographic=new OrthographicFrustum,scratchPackQuaternion=new Quaternion,scratchPackorigin=new Cartesian3;FrustumOutlineGeometry.unpack=function(e,t,r){Check.defined("array",e),t=defaultValue(t,0);var i,n=e[t++];n===PERSPECTIVE?(i=PerspectiveFrustum.unpack(e,t,scratchPackPerspective),t+=PerspectiveFrustum.packedLength):(i=OrthographicFrustum.unpack(e,t,scratchPackOrthographic),t+=OrthographicFrustum.packedLength);var a=Cartesian3.unpack(e,t,scratchPackorigin);t+=Cartesian3.packedLength;var o=Quaternion.unpack(e,t,scratchPackQuaternion),u=1===e[t+=Quaternion.packedLength];if(!defined(r))return new FrustumOutlineGeometry({frustum:i,origin:a,orientation:o,_drawNearPlane:u});var s=n===r._frustumType?r._frustum:void 0;return r._frustum=i.clone(s),r._frustumType=n,r._origin=Cartesian3.clone(a,r._origin),r._orientation=Quaternion.clone(o,r._orientation),r._drawNearPlane=u,r},FrustumOutlineGeometry.createGeometry=function(e){var t=e._frustumType,r=e._frustum,i=e._origin,n=e._orientation,a=e._drawNearPlane,o=new Float64Array(24);FrustumGeometry._computeNearFarPlanes(i,n,t,r,o);for(var u,s,c=new GeometryAttributes({position:new GeometryAttribute({componentDatatype:ComponentDatatype.DOUBLE,componentsPerAttribute:3,values:o})}),m=a?2:1,p=new Uint16Array(8*(m+1)),h=a?0:1;h<2;++h)s=4*h,p[u=a?8*h:0]=s,p[u+1]=s+1,p[u+2]=s+1,p[u+3]=s+2,p[u+4]=s+2,p[u+5]=s+3,p[u+6]=s+3,p[u+7]=s;for(h=0;h<2;++h)s=4*h,p[u=8*(m+h)]=s,p[u+1]=s+4,p[u+2]=s+1,p[u+3]=s+5,p[u+4]=s+2,p[u+5]=s+6,p[u+6]=s+3,p[u+7]=s+7;return new Geometry({attributes:c,indices:p,primitiveType:PrimitiveType.LINES,boundingSphere:BoundingSphere.fromVertices(o)})};export default FrustumOutlineGeometry;