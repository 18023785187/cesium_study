import Check from"./Check.js";import defaultValue from"./defaultValue.js";import defined from"./defined.js";function Heap(t){Check.typeOf.object("options",t),Check.defined("options.comparator",t.comparator),this._comparator=t.comparator,this._array=[],this._length=0,this._maximumLength=void 0}function swap(t,e,r){var a=t[e];t[e]=t[r],t[r]=a}Object.defineProperties(Heap.prototype,{length:{get:function(){return this._length}},internalArray:{get:function(){return this._array}},maximumLength:{get:function(){return this._maximumLength},set:function(t){Check.typeOf.number.greaterThanOrEquals("maximumLength",t,0);var e=this._length;if(t<e){for(var r=this._array,a=t;a<e;++a)r[a]=void 0;this._length=t,r.length=t}this._maximumLength=t}},comparator:{get:function(){return this._comparator}}}),Heap.prototype.reserve=function(t){t=defaultValue(t,this._length),this._array.length=t},Heap.prototype.heapify=function(t){t=defaultValue(t,0);for(var e=this._length,r=this._comparator,a=this._array,i=-1,n=!0;n;){var h=2*(t+1),o=h-1;i=o<e&&r(a[o],a[t])<0?o:t,h<e&&r(a[h],a[i])<0&&(i=h),i!==t?(swap(a,i,t),t=i):n=!1}},Heap.prototype.resort=function(){for(var t=this._length,e=Math.ceil(t/2);e>=0;--e)this.heapify(e)},Heap.prototype.insert=function(t){Check.defined("element",t);var e,r=this._array,a=this._comparator,i=this._maximumLength,n=this._length++;for(n<r.length?r[n]=t:r.push(t);0!==n;){var h=Math.floor((n-1)/2);if(!(a(r[n],r[h])<0))break;swap(r,n,h),n=h}return defined(i)&&this._length>i&&(e=r[i],this._length=i),e},Heap.prototype.pop=function(t){if(t=defaultValue(t,0),0!==this._length){Check.typeOf.number.lessThan("index",t,this._length);var e=this._array,r=e[t];return swap(e,t,--this._length),this.heapify(t),e[this._length]=void 0,r}};export default Heap;